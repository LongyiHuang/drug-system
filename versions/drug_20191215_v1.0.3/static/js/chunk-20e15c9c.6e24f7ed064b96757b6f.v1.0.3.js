(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20e15c9c"],{"1e0f":function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return s}));var r=a("4279"),i=function(e){return r["a"].request("/drugs","get",e,{showLoading:!0})},n=function(e){return r["a"].request("/drugs","get",e)},l=function(e){return r["a"].request("/drugs","post",e,{showLoading:!0})},o=function(e){return r["a"].request("/drugs/".concat(e.id),"patch",e,{showLoading:!0})},s=function(e){return r["a"].request("/drugs/".concat(e),"delete",{},{showLoading:!0})}},"339e":function(e,t,a){"use strict";var r=a("c2df"),i=a.n(r);i.a},"3cd9":function(e,t,a){"use strict";var r=a("eac9"),i=a.n(r);i.a},"4dce":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("31f0"),a("8bc6"),a("e8b0"),a("80f9"),a("dc2b"),a("ff52"),a("a27f");var r=a("f010"),i=(a("63ff"),a("a5db"));function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var o={data:function(){return{dataSource:[],total:0,currentPage:1,pageSize:i["a"],apiRequest:void 0,params:void 0}},methods:{getDataSource:function(e,t){var a,r;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:return this.apiRequest=e,this.params=t,a=l({currentPage:this.currentPage,pageSize:this.pageSize},this.params),i.next=7,regeneratorRuntime.awrap(e(a));case 7:r=i.sent,this.dataSource=r.rows,this.total=r.total;case 10:case"end":return i.stop()}}),null,this)},handlePageChange:function(e){this.currentPage=e,this.getDataSource(this.apiRequest,this.params)},handlePageSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.getDataSource(this.apiRequest,this.params)}}}},"6b9e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("HeaderWrapper",[a("ListFilterBar",{attrs:{slot:"left",filters:e.filters,clearable:!1},on:{onFilter:e.handleSearch},slot:"left"}),e.showAddDrug?a("el-button",{attrs:{slot:"right",type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.showAddDrugDialog=!0}},slot:"right"},[e._v(" 新增药品 ")]):e._e()],1),a("DrugList",{ref:"drugList",on:{onClickEdit:e.handleClickEdit,onClickDelete:e.handleDeleteDrug}}),e.showAddDrugDialog?a("el-dialog",{attrs:{title:"添加药品",visible:e.showAddDrugDialog,"before-close":function(){e.showAddDrugDialog=!1},"close-on-click-modal":!1}},[a("DrugForm",{on:{onSubmit:e.handleAddDrug}})],1):e._e(),e.showEditDrugDialog?a("el-dialog",{attrs:{title:"编辑药品",visible:e.showEditDrugDialog,"before-close":function(){e.showEditDrugDialog=!1},"close-on-click-modal":!1}},[a("DrugForm",{attrs:{"drug-detail":e.currentDrug},on:{onSubmit:e.handleEditDrug}})],1):e._e()],1)},i=[],n=(a("31f0"),a("8bc6"),a("01d3"),a("e8b0"),a("80f9"),a("dc2b"),a("ff52"),a("95a7"),a("a27f"),a("f010")),l=(a("63ff"),a("9fcc")),o=a("e0d0"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.dataSource}},[a("el-table-column",{attrs:{prop:"approvalNum",label:"批准文号"}}),a("el-table-column",{attrs:{prop:"genericName",label:"通用名"}}),a("el-table-column",{attrs:{prop:"name",label:"商品名"}}),a("el-table-column",{attrs:{prop:"typeName",label:"类型"}}),a("el-table-column",{attrs:{label:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.specificationList,(function(t,r){return a("span",{key:r},[e._v(" "+e._s(t.name)+" ")])}))}}])}),a("el-table-column",{attrs:{prop:"companyName",label:"生产厂家"}}),e.isAdmin?a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleClickDetail(t.row)}}},[e._v(" 编辑 ")]),a("el-popover",{attrs:{placement:"bottom"},model:{value:t.row.popoverVisble,callback:function(a){e.$set(t.row,"popoverVisble",a)},expression:"scope.row.popoverVisble"}},[a("p",[e._v("确认删除?")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){t.row.popoverVisble=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.handleClickDelete(t.row)}}},[e._v("确定")])],1),a("el-button",{staticStyle:{color:"red","margin-left":"5px"},attrs:{slot:"reference",type:"text"},on:{click:function(){e.dataSource.popoverVisble=!0}},slot:"reference"},[e._v(" 删除 ")])],1)]}}],null,!1,780596602)}):e._e()],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,50],"page-size":e.pageSize,layout:"total, prev, pager, next, sizes",total:e.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)},c=[],u=a("4dce"),p=a("1e0f"),d=a("a5db"),f={name:"DrugList",extends:u["a"],props:{showPrice:{type:Boolean,default:!1}},computed:{isAdmin:function(){var e=!1,t=this.$store.getters.roles;return t&&t.includes(d["b"].ADMIN)&&(e=!0),e}},mounted:function(){this.queryData()},methods:{queryData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.getDataSource(p["d"],e)},handleClickDetail:function(e){this.$emit("onClickEdit",e)},handleClickDelete:function(e){e.popoverVisble=!1,this.$emit("onClickDelete",e)}}},m=f,g=(a("3cd9"),a("4e82")),h=Object(g["a"])(m,s,c,!1,null,"00cfec65",null),b=h.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"drugDetail",attrs:{model:e.drugDetail,rules:e.rules,"label-width":"100px","label-suffix":":"}},[a("el-form-item",{attrs:{label:"商品名",prop:"name"}},[a("el-input",{staticClass:"normal-input",model:{value:e.drugDetail.name,callback:function(t){e.$set(e.drugDetail,"name",t)},expression:"drugDetail.name"}})],1),a("el-form-item",{attrs:{label:"通用名称",prop:"genericName"}},[a("el-input",{staticClass:"normal-input",model:{value:e.drugDetail.genericName,callback:function(t){e.$set(e.drugDetail,"genericName",t)},expression:"drugDetail.genericName"}})],1),a("el-form-item",{attrs:{label:"药品类型",prop:"type"}},[a("el-select",{model:{value:e.drugDetail.type,callback:function(t){e.$set(e.drugDetail,"type",t)},expression:"drugDetail.type"}},e._l(e.drugTypeOption,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"批准文号",prop:"approvalNum"}},[a("el-input",{staticClass:"normal-input",attrs:{disabled:e.editableApprovalNum},model:{value:e.drugDetail.approvalNum,callback:function(t){e.$set(e.drugDetail,"approvalNum",t)},expression:"drugDetail.approvalNum"}})],1),a("el-form-item",{attrs:{label:"生产厂家",prop:"companyName"}},[a("el-input",{staticClass:"normal-input",model:{value:e.drugDetail.companyName,callback:function(t){e.$set(e.drugDetail,"companyName",t)},expression:"drugDetail.companyName"}})],1),a("el-form-item",{attrs:{label:"批准日期",prop:"approvalDate"}},[a("el-date-picker",{attrs:{type:"date","value-format":"timestamp",placeholder:"选择日期"},model:{value:e.drugDetail.approvalDate,callback:function(t){e.$set(e.drugDetail,"approvalDate",t)},expression:"drugDetail.approvalDate"}})],1),a("el-form-item",{attrs:{label:"有效期",prop:"expiryDate"}},[a("el-date-picker",{attrs:{type:"date","value-format":"timestamp",placeholder:"选择日期"},model:{value:e.drugDetail.expiryDate,callback:function(t){e.$set(e.drugDetail,"expiryDate",t)},expression:"drugDetail.expiryDate"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")])],1)],1)},v=[],y={name:"DrugForm",props:{drugDetail:{type:Object,default:function(){return{}}}},computed:{editableApprovalNum:function(){return void 0!==this.drugDetail.id}},data:function(){return{drugTypeOption:[{name:"国产药",value:1},{name:"进口药",value:2}],rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],genericName:[{required:!0,message:"请输入通用名称",trigger:"blur"}],approvalNum:[{required:!0,message:"请输入批准文号",trigger:"blur"}],companyName:[{required:!0,message:"请输入生产厂家",trigger:"blur"}],approvalDate:[{required:!0,message:"请输入批准日期",trigger:"change"}],expiryDate:[{required:!0,message:"请输入有效日期",trigger:"change"}],type:[{required:!0,message:"请选择药品类型",trigger:"change"}]}}},methods:{submitForm:function(){var e=this;this.$refs["drugDetail"].validate((function(t){t&&e.$emit("onSubmit",e.drugDetail)}))}}},w=y,O=Object(g["a"])(w,D,v,!1,null,"4a87117e",null),k=O.exports;function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={name:"Drug",components:{DrugList:b,ListFilterBar:l["a"],HeaderWrapper:o["a"],DrugForm:k},data:function(){return{showAddDrugDialog:!1,showEditDrugDialog:!1,currentDrug:void 0,filters:[{type:"input",fieldName:"approvalNum",label:"批准文号",clearable:!0},{type:"input",fieldName:"genericName",label:"通用名",clearable:!0}]}},computed:{showAddDrug:function(){var e=!1,t=this.$store.getters.roles;return t&&t.includes(d["b"].ADMIN)&&(e=!0),e}},methods:{handleSearch:function(e){this.$refs["drugList"].queryData(e)},handleAddDrug:function(e){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(Object(p["a"])(e));case 2:this.showAddDrugDialog=!1,this.$message.success("添加成功"),this.$refs["drugList"].queryData();case 5:case"end":return t.stop()}}),null,this)},handleClickEdit:function(e){e&&(this.currentDrug=N({},e),this.showEditDrugDialog=!0)},handleEditDrug:function(e){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(Object(p["e"])(e));case 2:this.showEditDrugDialog=!1,this.$message.success("编辑成功"),this.$refs["drugList"].queryData();case 5:case"end":return t.stop()}}),null,this)},handleDeleteDrug:function(e){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,regeneratorRuntime.awrap(Object(p["b"])(e.id));case 3:this.$message.success("删除成功"),this.$refs["drugList"].queryData();case 5:case"end":return t.stop()}}),null,this)}}},P=_,j=Object(g["a"])(P,r,i,!1,null,"e1caa94a",null);t["default"]=j.exports},"9fcc":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"record-filter-container"},[e._l(e.filters,(function(t,r){return a("div",{key:r,staticClass:"filter-item"},[a("span",{staticClass:"normal-text"},[e._v(e._s(t.label))]),"timePickerRange"===t.type?a("el-date-picker",{staticClass:"time-picker-item",attrs:{size:"mini",type:"daterange",format:t.format,"value-format":"timestamp","range-separator":"至","start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder},model:{value:e.filterData[t.fieldName],callback:function(a){e.$set(e.filterData,t.fieldName,a)},expression:"filterData[item.fieldName]"}}):"input"===t.type?a("el-input",{attrs:{placeholder:t.placeholder,size:"mini",clearable:t.clearable},model:{value:e.filterData[t.fieldName],callback:function(a){e.$set(e.filterData,t.fieldName,a)},expression:"filterData[item.fieldName]"}}):"select"===t.type?a("el-select",{attrs:{placeholder:t.placeholder,size:"mini",clearable:t.clearable},model:{value:e.filterData[t.fieldName],callback:function(a){e.$set(e.filterData,t.fieldName,a)},expression:"filterData[item.fieldName]"}},e._l(e.filterData[t.fieldName+"Options"],(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),1):"numberRange"===t.type?a("section",{staticClass:"number-range-container"},[a("el-input-number",{attrs:{placeholder:t.startPlaceholder,size:"mini"},model:{value:e.filterData[t.fieldName][0],callback:function(a){e.$set(e.filterData[t.fieldName],0,a)},expression:"filterData[item.fieldName][0]"}}),a("span",{staticClass:"normal-text"},[e._v("至")]),a("el-input-number",{attrs:{placeholder:t.endPlaceholder,size:"mini"},model:{value:e.filterData[t.fieldName][1],callback:function(a){e.$set(e.filterData[t.fieldName],1,a)},expression:"filterData[item.fieldName][1]"}})],1):e._e()],1)})),a("div",{staticClass:"button-box"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleFilter}},[e._v("搜索")]),e.clearable?a("el-button",{attrs:{size:"mini"},on:{click:e.handleReset}},[e._v("重置")]):e._e()],1)],2)},i=[],n=(a("ad15"),a("dc2b"),a("ff52"),a("a27f"),a("63ff"),{name:"ListFilterBar",props:{filters:{type:Array,default:function(){return[]}},clearable:{type:Boolean,default:function(){return!0}}},data:function(){var e={};return this.filters.forEach((function(t){"select"===t.type?e[t.fieldName+"Options"]=t.options||[]:"numberRange"===t.type?e[t.fieldName]=[]:e[t.fieldName]=void 0})),{filterData:e}},mounted:function(){this.getSelectOptions()},methods:{getSelectOptions:function(){var e=this;this.filters.forEach((function(t){var a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:if("select"!==t.type){r.next=5;break}return r.next=3,regeneratorRuntime.awrap(t.optionApi());case 3:a=r.sent,e.filterData[t.fieldName+"Options"]=a.rows;case 5:case"end":return r.stop()}}))}))},handleReset:function(){var e=this;Object.keys(this.filterData).forEach((function(t){if(t.indexOf("Options")>=0&&e.filterData[t]instanceof Array)return!0;e.filterData[t]instanceof Array?e.filterData[t]=[]:e.filterData[t]=void 0})),this.$emit("onReset")},handleFilter:function(){var e=this,t={};this.filters.forEach((function(a){t[a.fieldName]=e.filterData[a.fieldName]})),this.$emit("onFilter",t)}}}),l=n,o=(a("bae7"),a("4e82")),s=Object(o["a"])(l,r,i,!1,null,"16a424b7",null);t["a"]=s.exports},bae7:function(e,t,a){"use strict";var r=a("cd27"),i=a.n(r);i.a},c2df:function(e,t,a){},cd27:function(e,t,a){},e0d0:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header-wrap"},[a("div",[e._t("left")],2),a("div",[e._t("right")],2)])},i=[],n={name:"HeaderWrapper"},l=n,o=(a("339e"),a("4e82")),s=Object(o["a"])(l,r,i,!1,null,"1c3b1d3c",null);t["a"]=s.exports},eac9:function(e,t,a){}}]);